\babel@toc {italian}{}\relax 
\babel@toc {italian}{}\relax 
\contentsline {section}{\numberline {1}NET\_01}{11}{section.1}%
\contentsline {subsection}{\numberline {1.1}Architettura di base e principi di rete}{11}{subsection.1.1}%
\contentsline {subsubsection}{\numberline {1.1.1}Definizione e interconnessione}{11}{subsubsection.1.1.1}%
\contentsline {subsubsection}{\numberline {1.1.2}Indirizzamento e instradamento}{11}{subsubsection.1.1.2}%
\contentsline {subsubsection}{\numberline {1.1.3}Anatomia dell'indirizzo IP e subnetting}{11}{subsubsection.1.1.3}%
\contentsline {paragraph}{\numberline {1.1.3.1}1) Cosa significa ``/27''}{12}{paragraph.1.1.3.1}%
\contentsline {paragraph}{\numberline {1.1.3.2}2) Perché basta guardare l'ultimo ottetto}{12}{paragraph.1.1.3.2}%
\contentsline {paragraph}{\numberline {1.1.3.3}3) Trova il blocco in cui cade 99}{12}{paragraph.1.1.3.3}%
\contentsline {paragraph}{\numberline {1.1.3.4}4) Verifica con l'AND (ultimo ottetto)}{13}{paragraph.1.1.3.4}%
\contentsline {paragraph}{\numberline {1.1.3.5}5) Broadcast: tutti i bit host a 1}{13}{paragraph.1.1.3.5}%
\contentsline {paragraph}{\numberline {1.1.3.6}6) Intervallo host e conteggio}{13}{paragraph.1.1.3.6}%
\contentsline {subsubsection}{\numberline {1.1.4}Sistemi autonomi (AS) e routing globale}{13}{subsubsection.1.1.4}%
\contentsline {subsubsection}{\numberline {1.1.5}La routing table e l'algoritmo di lookup}{13}{subsubsection.1.1.5}%
\contentsline {subsection}{\numberline {1.2}II. Il viaggio del pacchetto: esempio di richiesta DNS}{13}{subsection.1.2}%
\contentsline {subsubsection}{\numberline {1.2.1}Topologia e hop}{13}{subsubsection.1.2.1}%
\contentsline {subsubsection}{\numberline {1.2.2}Stack protocollare e incapsulamento}{14}{subsubsection.1.2.2}%
\contentsline {subsection}{\numberline {1.3}III. Vulnerabilità intrinseche di IP e TCP}{14}{subsection.1.3}%
\contentsline {subsubsection}{\numberline {1.3.1}Identificazione, spoofing e non-ripudio}{15}{subsubsection.1.3.1}%
\contentsline {subsubsection}{\numberline {1.3.2}Confidenzialità}{15}{subsubsection.1.3.2}%
\contentsline {subsubsection}{\numberline {1.3.3}Integrità dei dati}{15}{subsubsection.1.3.3}%
\contentsline {subsubsection}{\numberline {1.3.4}Packet replication e anti-replay}{15}{subsubsection.1.3.4}%
\contentsline {subsubsection}{\numberline {1.3.5}Insicurezza delle mappature dinamiche}{15}{subsubsection.1.3.5}%
\contentsline {subsection}{\numberline {1.4}Laboratorio 1: MiTM e DNS spoofing}{16}{subsection.1.4}%
\contentsline {subsubsection}{\numberline {1.4.1}Obiettivo e scenario}{16}{subsubsection.1.4.1}%
\contentsline {subsubsection}{\numberline {1.4.2}Fasi dell'attacco}{16}{subsubsection.1.4.2}%
\contentsline {subsubsection}{\numberline {1.4.3}STEP 1: ARP spoofing (MiTM)}{16}{subsubsection.1.4.3}%
\contentsline {subsubsection}{\numberline {1.4.4}STEP 2 \& 3: intercettazione e DNS spoofing}{17}{subsubsection.1.4.4}%
\contentsline {subsubsection}{\numberline {1.4.5}STEP 4: impersonificazione del sito web}{17}{subsubsection.1.4.5}%
\contentsline {section}{\numberline {2}NET\_02}{18}{section.2}%
\contentsline {subsection}{\numberline {2.1}Sicurezza delle Reti Ethernet LAN (Livello 2)}{18}{subsection.2.1}%
\contentsline {subsection}{\numberline {2.2}Perché la LAN Ethernet è fragile per natura}{18}{subsection.2.2}%
\contentsline {subsubsection}{\numberline {2.2.1}Frame, indirizzamento e forwarding}{18}{subsubsection.2.2.1}%
\contentsline {paragraph}{\numberline {2.2.1.1}Multiport Repeaters (Hub)}{18}{paragraph.2.2.1.1}%
\contentsline {paragraph}{\numberline {2.2.1.2}Bridge/Switches}{18}{paragraph.2.2.1.2}%
\contentsline {paragraph}{\numberline {2.2.1.3}Address Learning}{18}{paragraph.2.2.1.3}%
\contentsline {subsubsection}{\numberline {2.2.2}Topologie e controllo dei loop: STP}{19}{subsubsection.2.2.2}%
\contentsline {subsubsection}{\numberline {2.2.3}Adattamento del Livello 3 su Livello 2: DHCP, ARP e NDP}{20}{subsubsection.2.2.3}%
\contentsline {paragraph}{\numberline {2.2.3.1}DHCP — Dynamic Host Configuration Protocol (IPv4).}{20}{paragraph.2.2.3.1}%
\contentsline {paragraph}{\numberline {2.2.3.2}ARP — Address Resolution Protocol (IPv4).}{21}{paragraph.2.2.3.2}%
\contentsline {paragraph}{\numberline {2.2.3.3}NDP — Neighbor Discovery Protocol (IPv6).}{21}{paragraph.2.2.3.3}%
\contentsline {subsubsection}{\numberline {2.2.4}Vulnerabilità e minacce principali}{21}{subsubsection.2.2.4}%
\contentsline {paragraph}{\numberline {2.2.4.1}Accesso alla rete}{21}{paragraph.2.2.4.1}%
\contentsline {paragraph}{\numberline {2.2.4.2}Compromissione e controllo dello switch.}{22}{paragraph.2.2.4.2}%
\contentsline {paragraph}{\numberline {2.2.4.3}Riservatezza e intercettazione.}{22}{paragraph.2.2.4.3}%
\contentsline {paragraph}{\numberline {2.2.4.4}Integrità del traffico e attacchi Man-in-the-Middle (MITM)}{23}{paragraph.2.2.4.4}%
\contentsline {paragraph}{\numberline {2.2.4.5}Disponibilità e attacchi di Denial of Service (DoS)}{23}{paragraph.2.2.4.5}%
\contentsline {subsubsection}{\numberline {2.2.5}Contromisure: dal minimo sindacale al robusto}{24}{subsubsection.2.2.5}%
\contentsline {paragraph}{\numberline {2.2.5.1}Router-based security (segmentazione L3).}{24}{paragraph.2.2.5.1}%
\contentsline {subsubsection}{\numberline {2.2.6}Controllo d’accesso (Access Control)}{25}{subsubsection.2.2.6}%
\contentsline {paragraph}{\numberline {2.2.6.1}Obiettivo.}{25}{paragraph.2.2.6.1}%
\contentsline {paragraph}{\numberline {2.2.6.2}802.1X (port-based NAC).}{25}{paragraph.2.2.6.2}%
\contentsline {paragraph}{\numberline {2.2.6.3}Autorizzazione dinamica con 802.1X.}{25}{paragraph.2.2.6.3}%
\contentsline {paragraph}{\numberline {2.2.6.4}Port Security \& ACL sugli switch.}{25}{paragraph.2.2.6.4}%
\contentsline {paragraph}{\numberline {2.2.6.5}Segmentazione con VLAN (complemento).}{25}{paragraph.2.2.6.5}%
\contentsline {subsection}{\numberline {2.3}Laboratorio 2A: ACL L2 con Linux Bridge ed \texttt {ebtables} (binding MAC→porta)}{26}{subsection.2.3}%
\contentsline {paragraph}{\numberline {2.3.0.1}1) Preparazione host (MAC/IP dei client).}{26}{paragraph.2.3.0.1}%
\contentsline {paragraph}{\numberline {2.3.0.2}2) Creazione del bridge L2 (lato “switch” Linux).}{26}{paragraph.2.3.0.2}%
\contentsline {paragraph}{\numberline {2.3.0.3}3) ACL L2 con \texttt {ebtables} (NETFILTER).}{27}{paragraph.2.3.0.3}%
\contentsline {subsection}{\numberline {2.4}Laboratorio 2B: MACsec su Linux (confidenzialità, integrità e anti-replay a L2)}{27}{subsection.2.4}%
\contentsline {paragraph}{\numberline {2.4.0.1}Host A (\textbf {client1}).}{27}{paragraph.2.4.0.1}%
\contentsline {paragraph}{\numberline {2.4.0.2}Host B (\textbf {client2}).}{28}{paragraph.2.4.0.2}%
\contentsline {paragraph}{\numberline {2.4.0.3}Opzioni di sicurezza e test.}{28}{paragraph.2.4.0.3}%
\contentsline {subsubsection}{\numberline {2.4.1}Secure Address Resolution (IPv4/IPv6)}{29}{subsubsection.2.4.1}%
\contentsline {paragraph}{\numberline {2.4.1.1}IPv4: dal piano di switching ai vincoli per-presa.}{29}{paragraph.2.4.1.1}%
\contentsline {paragraph}{\numberline {2.4.1.2}IPv4: proposte crittografiche.}{29}{paragraph.2.4.1.2}%
\contentsline {paragraph}{\numberline {2.4.1.3}IPv6: NDP sicuro.}{29}{paragraph.2.4.1.3}%
\contentsline {subsubsection}{\numberline {2.4.2}Security Monitoring}{29}{subsubsection.2.4.2}%
\contentsline {paragraph}{\numberline {2.4.2.1}Firewall \& DPI.}{29}{paragraph.2.4.2.1}%
\contentsline {paragraph}{\numberline {2.4.2.2}IDS/IPS e accesso al traffico.}{29}{paragraph.2.4.2.2}%
\contentsline {paragraph}{\numberline {2.4.2.3}Dove il monitoring aiuta davvero.}{29}{paragraph.2.4.2.3}%
\contentsline {paragraph}{\numberline {2.4.2.4}Messaggio chiave (dalle slide).}{29}{paragraph.2.4.2.4}%
\contentsline {section}{\numberline {3}NET\_03 — Virtual LANs (VLAN)}{30}{section.3}%
\contentsline {subsubsection}{\numberline {3.0.1}Definizione e motivazione}{30}{subsubsection.3.0.1}%
\contentsline {subsubsection}{\numberline {3.0.2}Limiti delle reti fisicamente separate}{30}{subsubsection.3.0.2}%
\contentsline {paragraph}{\numberline {3.0.2.1}Benefici principali delle VLAN}{30}{paragraph.3.0.2.1}%
\contentsline {subsection}{\numberline {3.1}Assegnazione e membership delle VLAN}{31}{subsection.3.1}%
\contentsline {subsubsection}{\numberline {3.1.1}Criteri di assegnazione}{31}{subsubsection.3.1.1}%
\contentsline {subsubsection}{\numberline {3.1.2}Vista logica}{31}{subsubsection.3.1.2}%
\contentsline {paragraph}{\numberline {3.1.2.1}Router “one-armed”}{32}{paragraph.3.1.2.1}%
\contentsline {subsection}{\numberline {3.2}Trasporto dei frame: Tagging IEEE 802.1Q}{33}{subsection.3.2}%
\contentsline {subsubsection}{\numberline {3.2.1}Porte di tipo Access, Trunk e Hybrid}{33}{subsubsection.3.2.1}%
\contentsline {subsubsection}{\numberline {3.2.2}Access links}{33}{subsubsection.3.2.2}%
\contentsline {subsubsection}{\numberline {3.2.3}Access links nelle regioni legacy}{34}{subsubsection.3.2.3}%
\contentsline {subsubsection}{\numberline {3.2.4}Trunk links}{34}{subsubsection.3.2.4}%
\contentsline {subsubsection}{\numberline {3.2.5}Hybrid links}{35}{subsubsection.3.2.5}%
\contentsline {subsubsection}{\numberline {3.2.6}Una stazione può appartenere a più VLAN?}{36}{subsubsection.3.2.6}%
\contentsline {subsection}{\numberline {3.3}Laboratorio 3: Configurazione VLAN e router one-armed}{38}{subsection.3.3}%
\contentsline {paragraph}{\numberline {3.3.0.1}Isolamento del traffico}{39}{paragraph.3.3.0.1}%
\contentsline {paragraph}{\numberline {3.3.0.2}Routing inter-VLAN}{39}{paragraph.3.3.0.2}%
\contentsline {paragraph}{\numberline {3.3.0.3}Verifica del comportamento}{40}{paragraph.3.3.0.3}%
\contentsline {paragraph}{\numberline {3.3.0.4}Osservazione pratica}{40}{paragraph.3.3.0.4}%
\contentsline {subsection}{\numberline {3.4}Sicurezza delle VLAN e vulnerabilità di livello 2}{41}{subsection.3.4}%
\contentsline {subsubsection}{\numberline {3.4.1}Minacce principali}{41}{subsubsection.3.4.1}%
\contentsline {paragraph}{\numberline {3.4.1.1}1) MAC Flooding (CAM Overflow)}{41}{paragraph.3.4.1.1}%
\contentsline {paragraph}{\numberline {3.4.1.2}2) ARP Spoofing / Poisoning}{41}{paragraph.3.4.1.2}%
\contentsline {paragraph}{\numberline {3.4.1.3}3) VLAN Hopping}{42}{paragraph.3.4.1.3}%
\contentsline {paragraph}{\numberline {3.4.1.4}4) Attacchi ai protocolli di controllo}{42}{paragraph.3.4.1.4}%
\contentsline {subparagraph}{\numberline {3.4.1.4.1}Spanning Tree Attack (BPDU spoofing)}{43}{subparagraph.3.4.1.4.1}%
\contentsline {subparagraph}{\numberline {3.4.1.4.2}VTP Attack (VLAN Trunking Protocol)}{43}{subparagraph.3.4.1.4.2}%
\contentsline {subparagraph}{\numberline {3.4.1.4.3}Cisco Discovery Protocol Attack (information leakage)}{43}{subparagraph.3.4.1.4.3}%
\contentsline {subsection}{\numberline {3.5}Laboratorio 4: VLAN Hopping e Double Tagging}{44}{subsection.3.5}%
\contentsline {subsubsection}{\numberline {3.5.1}Scenario}{44}{subsubsection.3.5.1}%
\contentsline {subsubsection}{\numberline {3.5.2}Topologia del laboratorio}{44}{subsubsection.3.5.2}%
\contentsline {subsubsection}{\numberline {3.5.3}Prerequisiti perché l’attacco riesca}{45}{subsubsection.3.5.3}%
\contentsline {subsubsection}{\numberline {3.5.4}Funzionamento dell’attacco (passo–passo)}{45}{subsubsection.3.5.4}%
\contentsline {subsubsection}{\numberline {3.5.5}Esecuzione pratica (Linux)}{45}{subsubsection.3.5.5}%
\contentsline {paragraph}{\numberline {3.5.5.1}Cosa osservare con lo sniffer}{46}{paragraph.3.5.5.1}%
\contentsline {paragraph}{\numberline {3.5.5.2}Limitazioni pratiche}{46}{paragraph.3.5.5.2}%
\contentsline {paragraph}{\numberline {3.5.5.3}Mitigazioni}{46}{paragraph.3.5.5.3}%
\contentsline {section}{\numberline {4}NET\_04 — 802.1x}{47}{section.4}%
\contentsline {subsection}{\numberline {4.1}Quadro generale e obiettivo}{47}{subsection.4.1}%
\contentsline {subsection}{\numberline {4.2}Attori dell’architettura (vista di alto livello)}{47}{subsection.4.2}%
\contentsline {subsection}{\numberline {4.3}EAP ed EAPoL: fondamenti}{47}{subsection.4.3}%
\contentsline {paragraph}{\numberline {4.3.0.1}EAP (Extensible Authentication Protocol).}{47}{paragraph.4.3.0.1}%
\contentsline {subsection}{\numberline {4.4}EAP termination vs EAP relay (EAPoR)}{48}{subsection.4.4}%
\contentsline {paragraph}{\numberline {4.4.0.1} EAP termination mode (terminazione locale).}{48}{paragraph.4.4.0.1}%
\contentsline {paragraph}{\numberline {4.4.0.2} EAP relay mode (EAP over RADIUS, EAPoR).}{48}{paragraph.4.4.0.2}%
\contentsline {subsection}{\numberline {4.5}Processi di autenticazione: dai diagrammi alle implicazioni operative}{49}{subsection.4.5}%
\contentsline {paragraph}{\numberline {4.5.0.1}Message exchange (visione di alto livello).}{49}{paragraph.4.5.0.1}%
\contentsline {paragraph}{\numberline {4.5.0.2}Relay Mode (EAP-MD5) — sequenza dettagliata.}{50}{paragraph.4.5.0.2}%
\contentsline {paragraph}{\numberline {4.5.0.3}EAP-TLS: esempio più complesso.}{51}{paragraph.4.5.0.3}%
\contentsline {subsection}{\numberline {4.6}Operazioni aggiuntive: ri-autenticazione, logout, timer}{51}{subsection.4.6}%
\contentsline {subsection}{\numberline {4.7}Autorizzazione post-autenticazione: VLAN, ACL, UCL}{51}{subsection.4.7}%
\contentsline {paragraph}{\numberline {4.7.0.1}VLAN dinamiche.}{51}{paragraph.4.7.0.1}%
\contentsline {paragraph}{\numberline {4.7.0.2}ACL per-utente.}{51}{paragraph.4.7.0.2}%
\contentsline {paragraph}{\numberline {4.7.0.3}UCL (User Control List).}{52}{paragraph.4.7.0.3}%
\contentsline {subsection}{\numberline {4.8}Vulnerabilità storiche e motivazione per MACsec}{52}{subsection.4.8}%
\contentsline {subsection}{\numberline {4.9}Lab 5 — 802.1X Port-Based Authentication \& VLAN assignment}{53}{subsection.4.9}%
\contentsline {paragraph}{\numberline {4.9.0.1}Obiettivo.}{53}{paragraph.4.9.0.1}%
\contentsline {paragraph}{\numberline {4.9.0.2}Topologia di rete.}{53}{paragraph.4.9.0.2}%
\contentsline {paragraph}{\numberline {4.9.0.3}Configurazione dello switch (Authenticator).}{53}{paragraph.4.9.0.3}%
\contentsline {paragraph}{\numberline {4.9.0.4}Server di autenticazione (FreeRADIUS).}{54}{paragraph.4.9.0.4}%
\contentsline {paragraph}{\numberline {4.9.0.5}Configurazione dei client (Supplicant).}{54}{paragraph.4.9.0.5}%
\contentsline {paragraph}{\numberline {4.9.0.6}Controllo del traffico L2.}{54}{paragraph.4.9.0.6}%
\contentsline {paragraph}{\numberline {4.9.0.7}Sequenza operativa.}{54}{paragraph.4.9.0.7}%
\contentsline {paragraph}{\numberline {4.9.0.8}Osservazioni e risultati.}{55}{paragraph.4.9.0.8}%
\contentsline {paragraph}{\numberline {4.9.0.9}Conclusioni.}{55}{paragraph.4.9.0.9}%
\contentsline {subsection}{\numberline {4.10}MACsec e MKA (802.1AE + 802.1X-2010)}{56}{subsection.4.10}%
\contentsline {subsubsection}{\numberline {4.10.1}Perch\'e MKA: il tassello mancante dopo 802.1X}{56}{subsubsection.4.10.1}%
\contentsline {subsubsection}{\numberline {4.10.2}Le chiavi in gioco e come si ottengono}{56}{subsubsection.4.10.2}%
\contentsline {paragraph}{\numberline {4.10.2.1}CAK e CKN}{56}{paragraph.4.10.2.1}%
\contentsline {paragraph}{\numberline {4.10.2.2}ICK e KEK}{56}{paragraph.4.10.2.2}%
\contentsline {paragraph}{\numberline {4.10.2.3}SAK}{57}{paragraph.4.10.2.3}%
\contentsline {subsubsection}{\numberline {4.10.3}Due modalità d'uso del CAK}{57}{subsubsection.4.10.3}%
\contentsline {paragraph}{\numberline {4.10.3.1}Static CAK}{57}{paragraph.4.10.3.1}%
\contentsline {paragraph}{\numberline {4.10.3.2}Dynamic CAK}{57}{paragraph.4.10.3.2}%
\contentsline {subsubsection}{\numberline {4.10.4}Cosa si scambiano i peer: il ciclo MKA}{57}{subsubsection.4.10.4}%
\contentsline {paragraph}{\numberline {4.10.4.1}Annuncio, stato e priorit\`a}{57}{paragraph.4.10.4.1}%
\contentsline {paragraph}{\numberline {4.10.4.2}Elezione del Key Server}{57}{paragraph.4.10.4.2}%
\contentsline {paragraph}{\numberline {4.10.4.3}Apertura dei Secure Channel}{57}{paragraph.4.10.4.3}%
\contentsline {paragraph}{\numberline {4.10.4.4}Vita della sessione}{58}{paragraph.4.10.4.4}%
\contentsline {subsubsection}{\numberline {4.10.5}Collegamento con le policy 802.1X/NAC}{58}{subsubsection.4.10.5}%
\contentsline {subsection}{\numberline {4.11}Simple MKA lab with Linux}{59}{subsection.4.11}%
\contentsline {subsection}{\numberline {4.12}Laboratorio: MKA/MACsec su Linux (Static CAK)}{59}{subsection.4.12}%
\contentsline {subsubsection}{\numberline {4.12.1}Scopo}{59}{subsubsection.4.12.1}%
\contentsline {subsubsection}{\numberline {4.12.2}Topologia}{59}{subsubsection.4.12.2}%
\contentsline {subsubsection}{\numberline {4.12.3}Procedura}{59}{subsubsection.4.12.3}%
\contentsline {paragraph}{\numberline {4.12.3.1}Generazione delle chiavi (uguali su \emph {tutti} i peer)}{59}{paragraph.4.12.3.1}%
\contentsline {paragraph}{\numberline {4.12.3.2}Configurazione MKA su ciascun host}{59}{paragraph.4.12.3.2}%
\contentsline {paragraph}{\numberline {4.12.3.3}Avvio di MKA e creazione dell'interfaccia \texttt {macsec0}}{60}{paragraph.4.12.3.3}%
\contentsline {paragraph}{\numberline {4.12.3.4}Indirizzamento IP sulla \texttt {macsec0}}{60}{paragraph.4.12.3.4}%
\contentsline {paragraph}{\numberline {4.12.3.5}Test base di connettività}{60}{paragraph.4.12.3.5}%
\contentsline {subsubsection}{\numberline {4.12.4}Verifiche}{60}{subsubsection.4.12.4}%
\contentsline {paragraph}{\numberline {4.12.4.1}Log MKA}{60}{paragraph.4.12.4.1}%
\contentsline {paragraph}{\numberline {4.12.4.2}Stato interfaccia}{60}{paragraph.4.12.4.2}%
\contentsline {subsubsection}{\numberline {4.12.5}Troubleshooting}{60}{subsubsection.4.12.5}%
\contentsline {subsubsection}{\numberline {4.12.6}Pulizia}{60}{subsubsection.4.12.6}%
\contentsline {subsubsection}{\numberline {4.12.7}Estensioni \& domande d'esame}{60}{subsubsection.4.12.7}%
\contentsline {paragraph}{\numberline {4.12.7.1}Dynamic CAK (accenno)}{60}{paragraph.4.12.7.1}%
\contentsline {section}{\numberline {5}NET\_05 — Firewall e Algoritmi di Classificazione dei Pacchetti}{61}{section.5}%
\contentsline {subsection}{\numberline {5.1}Panoramica sui Firewall}{61}{subsection.5.1}%
\contentsline {subsubsection}{\numberline {5.1.1}Obiettivi di Progettazione dei Firewall}{61}{subsubsection.5.1.1}%
\contentsline {subsubsection}{\numberline {5.1.2}Politica di Accesso del Firewall}{61}{subsubsection.5.1.2}%
\contentsline {subsubsection}{\numberline {5.1.3}Caratteristiche dei Firewall}{62}{subsubsection.5.1.3}%
\contentsline {subsection}{\numberline {5.2}Firewall di Filtraggio dei Pacchetti}{62}{subsection.5.2}%
\contentsline {subsubsection}{\numberline {5.2.1}Vantaggi e Svantaggi del Filtraggio dei Pacchetti}{63}{subsubsection.5.2.1}%
\contentsline {subsection}{\numberline {5.3}Firewall di Ispezione Stateful}{64}{subsection.5.3}%
\contentsline {subsubsection}{\numberline {5.3.1}Tabella dello Stato delle Connessioni}{64}{subsubsection.5.3.1}%
\contentsline {subsection}{\numberline {5.4}Gateway e Funzione del Default Gateway}{65}{subsection.5.4}%
\contentsline {subsubsection}{\numberline {5.4.1}Funzioni di un Gateway}{65}{subsubsection.5.4.1}%
\contentsline {subsection}{\numberline {5.5}Application-Level Gateway (ALG)}{65}{subsection.5.5}%
\contentsline {subsubsection}{\numberline {5.5.1}Funzionamento dell'ALG}{65}{subsubsection.5.5.1}%
\contentsline {subsection}{\numberline {5.6}Circuit-Level Gateway}{65}{subsection.5.6}%
\contentsline {subsubsection}{\numberline {5.6.1}Funzione del Circuit-Level Gateway}{66}{subsubsection.5.6.1}%
\contentsline {subsection}{\numberline {5.7}Host-Based Firewall e Personal Firewall}{66}{subsection.5.7}%
\contentsline {subsection}{\numberline {5.8}NETFILTER}{66}{subsection.5.8}%
\contentsline {subsubsection}{\numberline {5.8.1}Funzionamento di NETFILTER}{66}{subsubsection.5.8.1}%
\contentsline {subsubsection}{\numberline {5.8.2}Le Tabelle di NETFILTER}{67}{subsubsection.5.8.2}%
\contentsline {subsubsection}{\numberline {5.8.3}Iptables: Il Frontend di NETFILTER}{68}{subsubsection.5.8.3}%
\contentsline {paragraph}{\numberline {5.8.3.1}Comandi principali di iptables}{68}{paragraph.5.8.3.1}%
\contentsline {subsubsection}{\numberline {5.8.4}Network Address Translation (NAT)}{69}{subsubsection.5.8.4}%
\contentsline {paragraph}{\numberline {5.8.4.1}Tipi di NAT}{69}{paragraph.5.8.4.1}%
\contentsline {subsubsection}{\numberline {5.8.5}Connection Tracking}{69}{subsubsection.5.8.5}%
\contentsline {paragraph}{\numberline {5.8.5.1}Esempi di stato delle connessioni}{69}{paragraph.5.8.5.1}%
\contentsline {subsubsection}{\numberline {5.8.6}Vantaggi e Limitazioni di NETFILTER}{69}{subsubsection.5.8.6}%
\contentsline {subsection}{\numberline {5.9}Lab 5 — Firewall con \texttt {iptables} e policy di sicurezza gateway/server}{71}{subsection.5.9}%
\contentsline {paragraph}{\numberline {5.9.0.1}Obiettivo e componenti.}{71}{paragraph.5.9.0.1}%
\contentsline {paragraph}{\numberline {5.9.0.2}Struttura del laboratorio.}{71}{paragraph.5.9.0.2}%
\contentsline {paragraph}{\numberline {5.9.0.3}Gateway (firewall principale).}{71}{paragraph.5.9.0.3}%
\contentsline {paragraph}{\numberline {5.9.0.4}Server DMZ.}{72}{paragraph.5.9.0.4}%
\contentsline {paragraph}{\numberline {5.9.0.5}Testing.}{72}{paragraph.5.9.0.5}%
\contentsline {subsection}{\numberline {5.10}Classificazione dei Pacchetti}{73}{subsection.5.10}%
\contentsline {subsubsection}{\numberline {5.10.1}Perché è Importante la Classificazione dei Pacchetti?}{73}{subsubsection.5.10.1}%
\contentsline {paragraph}{\numberline {5.10.1.1}Requisiti e metriche.}{73}{paragraph.5.10.1.1}%
\contentsline {subsubsection}{\numberline {5.10.2}Algoritmi di Classificazione dei Pacchetti}{73}{subsubsection.5.10.2}%
\contentsline {paragraph}{\numberline {5.10.2.1}Schema divide-and-conquer.}{74}{paragraph.5.10.2.1}%
\contentsline {subsection}{\numberline {5.11}Problema della Classificazione dei Pacchetti}{74}{subsection.5.11}%
\contentsline {subsubsection}{\numberline {5.11.1}Struttura delle Regole di Classificazione}{74}{subsubsection.5.11.1}%
\contentsline {subsubsection}{\numberline {5.11.2}Combinazione di Regole con Match Multipli}{74}{subsubsection.5.11.2}%
\contentsline {paragraph}{\numberline {5.11.2.1}Selezione efficiente della miglior regola.}{75}{paragraph.5.11.2.1}%
\contentsline {subsubsection}{\numberline {5.11.3}Algoritmi di Matching}{75}{subsubsection.5.11.3}%
\contentsline {paragraph}{\numberline {5.11.3.1}Altre famiglie chiave.}{75}{paragraph.5.11.3.1}%
\contentsline {subsection}{\numberline {5.12}Approccio Bit Vector Linear Search}{75}{subsection.5.12}%
\contentsline {subsubsection}{\numberline {5.12.1}Funzionamento del Bit Vector Linear Search}{76}{subsubsection.5.12.1}%
\contentsline {paragraph}{\numberline {5.12.1.1}Nota tecnica (integrazione e correzione).}{76}{paragraph.5.12.1.1}%
\contentsline {subsubsection}{\numberline {5.12.2}Vantaggi e Limiti del Bit Vector Linear Search}{76}{subsubsection.5.12.2}%
\contentsline {paragraph}{\numberline {5.12.2.1}Precisazione sulla memoria.}{76}{paragraph.5.12.2.1}%
\contentsline {subsection}{\numberline {5.13}Contenuto e Prestazioni della Classificazione dei Pacchetti}{76}{subsection.5.13}%
\contentsline {subsubsection}{\numberline {5.13.1}Caching 5-tuple: benefici e limiti}{77}{subsubsection.5.13.1}%
\contentsline {subsubsection}{\numberline {5.13.2}TCAM/CAM: pro e contro}{77}{subsubsection.5.13.2}%
\contentsline {subsection}{\numberline {5.14}eBPF}{77}{subsection.5.14}%
\contentsline {subsubsection}{\numberline {5.14.1}Hook eBPF (punti di aggancio)}{77}{subsubsection.5.14.1}%
\contentsline {subsubsection}{\numberline {5.14.2}Focus sui percorsi di rete}{77}{subsubsection.5.14.2}%
\contentsline {paragraph}{\numberline {5.14.2.1}XDP}{77}{paragraph.5.14.2.1}%
\contentsline {paragraph}{\numberline {5.14.2.2}JIT}{78}{paragraph.5.14.2.2}%
\contentsline {paragraph}{\numberline {5.14.2.3}TC}{78}{paragraph.5.14.2.3}%
\contentsline {paragraph}{\numberline {5.14.2.4}NETFILTER e Socket hooks}{78}{paragraph.5.14.2.4}%
\contentsline {subsection}{\numberline {5.15}Scrivere e caricare programmi eBPF}{78}{subsection.5.15}%
\contentsline {paragraph}{\numberline {5.15.0.1}Pipeline operativa }{78}{paragraph.5.15.0.1}%
\contentsline {paragraph}{\numberline {5.15.0.2}Componenti di supporto}{78}{paragraph.5.15.0.2}%
\contentsline {subsection}{\numberline {5.16}Laboratorio X: Warm-up con eBPF e XDP}{79}{subsection.5.16}%
\contentsline {subsubsection}{\numberline {5.16.1}Scenario}{79}{subsubsection.5.16.1}%
\contentsline {subsubsection}{\numberline {5.16.2}Topologia del laboratorio}{79}{subsubsection.5.16.2}%
\contentsline {subsubsection}{\numberline {5.16.3}Prerequisiti}{79}{subsubsection.5.16.3}%
\contentsline {subsubsection}{\numberline {5.16.4}Passi del laboratorio (step–by–step)}{79}{subsubsection.5.16.4}%
\contentsline {paragraph}{\numberline {5.16.4.1}Step 1 — Basic PASS con logging}{79}{paragraph.5.16.4.1}%
\contentsline {paragraph}{\numberline {5.16.4.2}Step 2 — Switch a DROP e detach}{80}{paragraph.5.16.4.2}%
\contentsline {paragraph}{\numberline {5.16.4.3}Step 3 — Packet Filtering (hardcoded) con boundary checks}{80}{paragraph.5.16.4.3}%
\contentsline {paragraph}{\numberline {5.16.4.4}Step 4 — Map Counter (pkt/byte)}{80}{paragraph.5.16.4.4}%
\contentsline {paragraph}{\numberline {5.16.4.5}Step 5 — ACL denylist con mappa hash}{80}{paragraph.5.16.4.5}%
\contentsline {subsubsection}{\numberline {5.16.5}Esecuzione pratica (comandi essenziali)}{80}{subsubsection.5.16.5}%
\contentsline {subsubsection}{\numberline {5.16.6}Cosa osservare con lo sniffer / tracing}{81}{subsubsection.5.16.6}%
\contentsline {paragraph}{\numberline {5.16.6.1}Troubleshooting}{81}{paragraph.5.16.6.1}%
\contentsline {subsubsection}{\numberline {5.16.7}Limitazioni pratiche}{81}{subsubsection.5.16.7}%
\contentsline {subsubsection}{\numberline {5.16.8}Mitigazioni / buone pratiche}{81}{subsubsection.5.16.8}%
\contentsline {section}{\numberline {6}NET\_06 - Secure Protocols and Overlay VPNs}{82}{section.6}%
\contentsline {subsection}{\numberline {6.1}Sicurezza a livello applicativo: Secure Shell (SSH)}{82}{subsection.6.1}%
\contentsline {paragraph}{\numberline {6.1.0.1}Architettura e RFC.}{82}{paragraph.6.1.0.1}%
\contentsline {paragraph}{\numberline {6.1.0.2}Obiettivi di sicurezza.}{82}{paragraph.6.1.0.2}%
\contentsline {paragraph}{\numberline {6.1.0.3}Cifratura e handshake.}{82}{paragraph.6.1.0.3}%
\contentsline {paragraph}{\numberline {6.1.0.4}Autenticazione del server.}{83}{paragraph.6.1.0.4}%
\contentsline {paragraph}{\numberline {6.1.0.5}Autenticazione del client.}{84}{paragraph.6.1.0.5}%
\contentsline {paragraph}{\numberline {6.1.0.6}Servizi aggiuntivi.}{84}{paragraph.6.1.0.6}%
\contentsline {paragraph}{\numberline {6.1.0.7}Conclusione.}{85}{paragraph.6.1.0.7}%
\contentsline {subsection}{\numberline {6.2}Sicurezza a livello di trasporto: Transport Layer Security (TLS)}{85}{subsection.6.2}%
\contentsline {paragraph}{\numberline {6.2.0.1}Obiettivi di TLS.}{85}{paragraph.6.2.0.1}%
\contentsline {paragraph}{\numberline {6.2.0.2}Ruolo nello stack di rete.}{86}{paragraph.6.2.0.2}%
\contentsline {paragraph}{\numberline {6.2.0.3}Esempio pratico.}{86}{paragraph.6.2.0.3}%
\contentsline {paragraph}{\numberline {6.2.0.4}Storia e porte standard.}{86}{paragraph.6.2.0.4}%
\contentsline {paragraph}{\numberline {6.2.0.5}Funzionamento.}{87}{paragraph.6.2.0.5}%
\contentsline {paragraph}{\numberline {6.2.0.6}Evoluzione a TLS 1.3.}{87}{paragraph.6.2.0.6}%
\contentsline {paragraph}{\numberline {6.2.0.7}Attacchi noti.}{88}{paragraph.6.2.0.7}%
\contentsline {subsection}{\numberline {6.3}Laboratorio: HTTPS con Apache2}{89}{subsection.6.3}%
\contentsline {paragraph}{\numberline {6.3.0.1}1. Creazione della CA.}{89}{paragraph.6.3.0.1}%
\contentsline {paragraph}{\numberline {6.3.0.2}2. Configurazione di Apache2.}{89}{paragraph.6.3.0.2}%
\contentsline {paragraph}{\numberline {6.3.0.3}3. Accesso e verifica.}{89}{paragraph.6.3.0.3}%
\contentsline {paragraph}{\numberline {6.3.0.4}Redirect da HTTP a HTTPS.}{89}{paragraph.6.3.0.4}%
\contentsline {subsection}{\numberline {6.4}Attacchi di downgrade e contromisure}{90}{subsection.6.4}%
\contentsline {paragraph}{\numberline {6.4.0.1}HSTS.}{90}{paragraph.6.4.0.1}%
\contentsline {subsection}{\numberline {6.5}Overlay VPNs e OpenVPN}{90}{subsection.6.5}%
\contentsline {paragraph}{\numberline {6.5.0.1}Concetto di tunneling.}{90}{paragraph.6.5.0.1}%
\contentsline {subsubsection}{\numberline {6.5.1}OpenVPN}{90}{subsubsection.6.5.1}%
\contentsline {paragraph}{\numberline {6.5.1.1}Architettura.}{90}{paragraph.6.5.1.1}%
\contentsline {paragraph}{\numberline {6.5.1.2}Configurazione di base.}{91}{paragraph.6.5.1.2}%
\contentsline {paragraph}{\numberline {6.5.1.3}Routing e NAT.}{91}{paragraph.6.5.1.3}%
\contentsline {paragraph}{\numberline {6.5.1.4}Autenticazione e cifratura.}{91}{paragraph.6.5.1.4}%
\contentsline {paragraph}{\numberline {6.5.1.5}Vantaggi.}{91}{paragraph.6.5.1.5}%
\contentsline {subsection}{\numberline {6.6}Conclusione}{91}{subsection.6.6}%
\contentsline {section}{\numberline {7}SYS\_01 — Introduzione ai Security Frameworks}{92}{section.7}%
\contentsline {subsection}{\numberline {7.1}Quadro generale e obiettivo}{92}{subsection.7.1}%
\contentsline {subsection}{\numberline {7.2}Principi fondamentali}{92}{subsection.7.2}%
\contentsline {paragraph}{\numberline {7.2.0.1}Confidenzialità}{92}{paragraph.7.2.0.1}%
\contentsline {paragraph}{\numberline {7.2.0.2}Integrità}{92}{paragraph.7.2.0.2}%
\contentsline {paragraph}{\numberline {7.2.0.3}Disponibilità}{92}{paragraph.7.2.0.3}%
\contentsline {paragraph}{\numberline {7.2.0.4}Autenticità e Autorizzazione}{93}{paragraph.7.2.0.4}%
\contentsline {paragraph}{\numberline {7.2.0.5}Accountability}{93}{paragraph.7.2.0.5}%
\contentsline {paragraph}{\numberline {7.2.0.6}Dipendibilità}{93}{paragraph.7.2.0.6}%
\contentsline {subsection}{\numberline {7.3}Perché servono i Security Frameworks}{94}{subsection.7.3}%
\contentsline {subsection}{\numberline {7.4}Tre famiglie a confronto}{94}{subsection.7.4}%
\contentsline {subsubsection}{\numberline {7.4.1}FIPS 200 — Requisiti minimi per i sistemi federali}{94}{subsubsection.7.4.1}%
\contentsline {subsubsection}{\numberline {7.4.2}CIS Critical Security Controls — L’igiene prioritaria}{94}{subsubsection.7.4.2}%
\contentsline {subsubsection}{\numberline {7.4.3}ISO/IEC 27000 — ISMS e gestione del rischio}{95}{subsubsection.7.4.3}%
\contentsline {section}{\numberline {8}SYS\_02 — Hardware Primer}{96}{section.8}%
\contentsline {subsection}{\numberline {8.1}Moore’s Law e l’evoluzione del calcolo}{96}{subsection.8.1}%
\contentsline {subsection}{\numberline {8.2}Fine della crescita lineare e parallelismo}{96}{subsection.8.2}%
\contentsline {subsection}{\numberline {8.3}Pipeline e architettura superscalare}{96}{subsection.8.3}%
\contentsline {subsection}{\numberline {8.4}Branch Prediction: principi e strategie}{96}{subsection.8.4}%
\contentsline {paragraph}{\numberline {8.4.0.1}Perché serve una predizione}{97}{paragraph.8.4.0.1}%
\contentsline {paragraph}{\numberline {8.4.0.2}Tipi di predizione}{97}{paragraph.8.4.0.2}%
\contentsline {paragraph}{\numberline {8.4.0.3}Contatore a 2 bit saturante}{97}{paragraph.8.4.0.3}%
\contentsline {paragraph}{\numberline {8.4.0.4}Predittori correlati e multilivello}{97}{paragraph.8.4.0.4}%
\contentsline {paragraph}{\numberline {8.4.0.5}Ottimizzazioni hardware}{98}{paragraph.8.4.0.5}%
\contentsline {paragraph}{\numberline {8.4.0.6}Importanza crescente della predizione}{98}{paragraph.8.4.0.6}%
\contentsline {subsection}{\numberline {8.5}Simultaneous Multithreading (SMT)}{99}{subsection.8.5}%
\contentsline {subsection}{\numberline {8.6}Pipeline interna nei processori Intel Xeon}{99}{subsection.8.6}%
\contentsline {subsection}{\numberline {8.7}Gerarchia di memoria}{100}{subsection.8.7}%
\contentsline {paragraph}{\numberline {8.7.0.1}Inclusività e mappatura}{100}{paragraph.8.7.0.1}%
\contentsline {paragraph}{\numberline {8.7.0.2}Sostituzione ed aggiornamento}{102}{paragraph.8.7.0.2}%
\contentsline {subsection}{\numberline {8.8}Cache coherence nei multicore}{103}{subsection.8.8}%
\contentsline {paragraph}{\numberline {8.8.0.1}Protocolli di coerenza}{104}{paragraph.8.8.0.1}%
\contentsline {subsection}{\numberline {8.9}Protocolli MOESI e VI}{105}{subsection.8.9}%
\contentsline {paragraph}{\numberline {8.9.0.1}Virtual vs. Physical Cache Indexing}{106}{paragraph.8.9.0.1}%
\contentsline {subsection}{\numberline {8.10}Hardware Transactional Memory (HTM)}{107}{subsection.8.10}%
\contentsline {paragraph}{\numberline {8.10.0.1}Principio di funzionamento}{107}{paragraph.8.10.0.1}%
\contentsline {paragraph}{\numberline {8.10.0.2}Casi di abort e codici di stato}{108}{paragraph.8.10.0.2}%
\contentsline {subsection}{\numberline {8.11}DRAM e Refresh}{108}{subsection.8.11}%
\contentsline {paragraph}{\numberline {8.11.0.1}Effetti del refresh}{108}{paragraph.8.11.0.1}%
\contentsline {section}{\numberline {9}SYS\_04 - Hardware attacks and countermeasures}{110}{section.9}%
\contentsline {subsection}{\numberline {9.1}Introduzione agli Attacchi Hardware}{110}{subsection.9.1}%
\contentsline {subsection}{\numberline {9.2}Timing e Sicurezza}{110}{subsection.9.2}%
\contentsline {paragraph}{\numberline {9.2.0.1}Uso della Funzione strcmp}{110}{paragraph.9.2.0.1}%
\contentsline {paragraph}{\numberline {9.2.0.2}Timing attack in un Programma di Autenticazione}{110}{paragraph.9.2.0.2}%
\contentsline {subsubsection}{\numberline {9.2.1}Attacchi di Temporizzazione nel Mondo Reale: RSA}{110}{subsubsection.9.2.1}%
\contentsline {paragraph}{\numberline {9.2.1.1}Attacchi alla Decrittazione RSA}{111}{paragraph.9.2.1.1}%
\contentsline {paragraph}{\numberline {9.2.1.2}Algoritmi a Tempo Costante}{111}{paragraph.9.2.1.2}%
\contentsline {subsection}{\numberline {9.3}Preambolo: Side-Channel Attacks e Considerazioni Tecniche}{111}{subsection.9.3}%
\contentsline {paragraph}{\numberline {9.3.0.1}Fasi operative}{111}{paragraph.9.3.0.1}%
\contentsline {paragraph}{\numberline {9.3.0.2}Scoprire i percorsi di codice}{111}{paragraph.9.3.0.2}%
\contentsline {subsubsection}{\numberline {9.3.1}Technical Considerations}{112}{subsubsection.9.3.1}%
\contentsline {paragraph}{\numberline {9.3.1.1}Nota pratica (TSX e detection)}{112}{paragraph.9.3.1.1}%
\contentsline {subsection}{\numberline {9.4}Attacchi side channel}{112}{subsection.9.4}%
\contentsline {subsubsection}{\numberline {9.4.1}Timing della Cache}{112}{subsubsection.9.4.1}%
\contentsline {paragraph}{\numberline {9.4.1.1}Attacchi Flush + Reload}{112}{paragraph.9.4.1.1}%
\contentsline {paragraph}{\numberline {9.4.1.2}Evict + Time}{112}{paragraph.9.4.1.2}%
\contentsline {paragraph}{\numberline {9.4.1.3}Attacchi Prime + Probe}{113}{paragraph.9.4.1.3}%
\contentsline {paragraph}{\numberline {9.4.1.4}Prime + Abort}{113}{paragraph.9.4.1.4}%
\contentsline {paragraph}{\numberline {9.4.1.5}Flush + Flush}{113}{paragraph.9.4.1.5}%
\contentsline {subsubsection}{\numberline {9.4.2}Meeting Out-of-Order Pipelines: perché conta per la sicurezza}{113}{subsubsection.9.4.2}%
\contentsline {subsubsection}{\numberline {9.4.3}Meltdown: come funziona (Primer)}{114}{subsubsection.9.4.3}%
\contentsline {paragraph}{\numberline {9.4.3.1}Idea chiave}{114}{paragraph.9.4.3.1}%
\contentsline {paragraph}{\numberline {9.4.3.2}Schema operativo Meltdown}{114}{paragraph.9.4.3.2}%
\contentsline {paragraph}{\numberline {9.4.3.3}Perché è possibile}{114}{paragraph.9.4.3.3}%
\contentsline {subsubsection}{\numberline {9.4.4}Fooling the Branch Prediction Unit (BPU)}{114}{subsubsection.9.4.4}%
\contentsline {paragraph}{\numberline {9.4.4.1}Dove si colpisce e perché funziona}{115}{paragraph.9.4.4.1}%
\contentsline {subsubsection}{\numberline {9.4.5}Spectre Primer v1 (Bounds Check Bypass)}{115}{subsubsection.9.4.5}%
\contentsline {subsubsection}{\numberline {9.4.6}Spectre Primer v2 (BTB Poisoning e Gadget)}{115}{subsubsection.9.4.6}%
\contentsline {paragraph}{\numberline {9.4.6.1}Esempio di gadget dalle slide (Windows 10)}{116}{paragraph.9.4.6.1}%
\contentsline {paragraph}{\numberline {9.4.6.2}Requisiti e note}{116}{paragraph.9.4.6.2}%
\contentsline {subsubsection}{\numberline {9.4.7}L1TF (Foreshadow): principio e flusso}{116}{subsubsection.9.4.7}%
\contentsline {paragraph}{\numberline {9.4.7.1}Perché funziona}{116}{paragraph.9.4.7.1}%
\contentsline {paragraph}{\numberline {9.4.7.2}Schema operativo (dalle slide)}{116}{paragraph.9.4.7.2}%
\contentsline {subsubsection}{\numberline {9.4.8}Mitigating Side-Channel Attacks}{117}{subsubsection.9.4.8}%
\contentsline {paragraph}{\numberline {9.4.8.1}Possible Mitigations and Detection}{117}{paragraph.9.4.8.1}%
\contentsline {paragraph}{\numberline {9.4.8.2}Mitigations: the hard way}{117}{paragraph.9.4.8.2}%
\contentsline {paragraph}{\numberline {9.4.8.3}Mitigations to L1 Attacks}{118}{paragraph.9.4.8.3}%
\contentsline {paragraph}{\numberline {9.4.8.4}Mitigations: the detection way}{118}{paragraph.9.4.8.4}%
\contentsline {paragraph}{\numberline {9.4.8.5}Meltdown Mitigation: Kernel Page Table Isolation}{118}{paragraph.9.4.8.5}%
\contentsline {subsubsection}{\numberline {9.4.9}cpu\_entry\_area: Per-CPU Isolation}{118}{subsubsection.9.4.9}%
\contentsline {subsubsection}{\numberline {9.4.10}Double Page General Directory e Switch to CR3}{119}{subsubsection.9.4.10}%
\contentsline {subsubsection}{\numberline {9.4.11}Retpoline: Protezione contro gli Attacchi di Branch Target Injection e Retpoline Thunks}{119}{subsubsection.9.4.11}%
\contentsline {subsubsection}{\numberline {9.4.12}Prevent Branch Poisoning: IBRS, STIBP, IBPB}{120}{subsubsection.9.4.12}%
\contentsline {subsection}{\numberline {9.5}RowHammer: Attacco alla Memoria e le sue Mitigazioni}{120}{subsection.9.5}%
\contentsline {subsection}{\numberline {9.6}Memory Performance Attacks: Attacchi alle Prestazioni della Memoria}{121}{subsection.9.6}%
\contentsline {paragraph}{\numberline {9.6.0.1}Denial of Service nei Sistemi Multi-Core}{121}{paragraph.9.6.0.1}%
\contentsline {paragraph}{\numberline {9.6.0.2}Funzionamento degli Attacchi a Memoria Multi-Banca}{122}{paragraph.9.6.0.2}%
\contentsline {paragraph}{\numberline {9.6.0.3}Scheduling della Memoria e Contesa tra Banchi}{122}{paragraph.9.6.0.3}%
\contentsline {paragraph}{\numberline {9.6.0.4}Mitigazioni e Strategie di Ottimizzazione}{122}{paragraph.9.6.0.4}%
\contentsline {section}{\numberline {10}SYS\_05 - OS Security Principles}{123}{section.10}%
\contentsline {subsection}{\numberline {10.1}Introduzione}{123}{subsection.10.1}%
\contentsline {subsection}{\numberline {10.2}Identificazione e Autenticazione degli Utenti}{123}{subsection.10.2}%
\contentsline {paragraph}{\numberline {10.2.0.1}/etc/passwd}{123}{paragraph.10.2.0.1}%
\contentsline {paragraph}{\numberline {10.2.0.2}/etc/shadow}{123}{paragraph.10.2.0.2}%
\contentsline {subsection}{\numberline {10.3}Gestione degli UID e dei Privilegi}{124}{subsection.10.3}%
\contentsline {paragraph}{\numberline {10.3.0.1}su e sudo}{124}{paragraph.10.3.0.1}%
\contentsline {subsection}{\numberline {10.4}Principio del Minimo Privilegio}{124}{subsection.10.4}%
\contentsline {subsection}{\numberline {10.5}Controllo degli Accessi}{124}{subsection.10.5}%
\contentsline {subsubsection}{\numberline {10.5.1}Politiche di Sicurezza: DAC e MAC}{125}{subsubsection.10.5.1}%
\contentsline {subsubsection}{\numberline {10.5.2}POSIX ACL e Access Control Fine-Grained}{125}{subsubsection.10.5.2}%
\contentsline {paragraph}{\numberline {10.5.2.1}Esempio di ACL POSIX}{125}{paragraph.10.5.2.1}%
\contentsline {paragraph}{\numberline {10.5.2.2}Meccanismo di valutazione delle ACL}{126}{paragraph.10.5.2.2}%
\contentsline {subparagraph}{\numberline {10.5.2.2.1}Fase (i): Selezione della voce corrispondente}{126}{subparagraph.10.5.2.2.1}%
\contentsline {subparagraph}{\numberline {10.5.2.2.2}Fase (ii): Decisione finale sull’accesso}{126}{subparagraph.10.5.2.2.2}%
\contentsline {paragraph}{\numberline {10.5.2.3}Ruolo della Mask}{126}{paragraph.10.5.2.3}%
\contentsline {subsection}{\numberline {10.6}Linux Capabilities}{126}{subsection.10.6}%
\contentsline {paragraph}{\numberline {10.6.0.1}Esempi di capability}{127}{paragraph.10.6.0.1}%
\contentsline {paragraph}{\numberline {10.6.0.2}Implementazione nel kernel}{127}{paragraph.10.6.0.2}%
\contentsline {paragraph}{\numberline {10.6.0.3}Insiemi di capability di un thread}{127}{paragraph.10.6.0.3}%
\contentsline {paragraph}{\numberline {10.6.0.4}File capabilities}{128}{paragraph.10.6.0.4}%
\contentsline {paragraph}{\numberline {10.6.0.5}Capability Bounding Set}{128}{paragraph.10.6.0.5}%
\contentsline {subsection}{\numberline {10.7}Linux Security Modules (LSM)}{128}{subsection.10.7}%
\contentsline {paragraph}{\numberline {10.7.0.1}Concetto di base}{128}{paragraph.10.7.0.1}%
\contentsline {paragraph}{\numberline {10.7.0.2}Struttura generale}{128}{paragraph.10.7.0.2}%
\contentsline {paragraph}{\numberline {10.7.0.3}Funzionamento del framework}{129}{paragraph.10.7.0.3}%
\contentsline {paragraph}{\numberline {10.7.0.4}Hook di sicurezza}{129}{paragraph.10.7.0.4}%
\contentsline {paragraph}{\numberline {10.7.0.5}Categorie di hook}{130}{paragraph.10.7.0.5}%
\contentsline {paragraph}{\numberline {10.7.0.6}Esempio: hook su un file system}{130}{paragraph.10.7.0.6}%
\contentsline {paragraph}{\numberline {10.7.0.7}Estensioni del kernel per LSM}{130}{paragraph.10.7.0.7}%
\contentsline {subsubsection}{\numberline {10.7.1}Esempi di Moduli MAC}{131}{subsubsection.10.7.1}%
\contentsline {paragraph}{\numberline {10.7.1.1}S.M.A.C.K. (Simplified Mandatory Access Control Kernel)}{131}{paragraph.10.7.1.1}%
\contentsline {paragraph}{\numberline {10.7.1.2}Etichette di default}{131}{paragraph.10.7.1.2}%
\contentsline {paragraph}{\numberline {10.7.1.3}SMACKFS}{132}{paragraph.10.7.1.3}%
\contentsline {paragraph}{\numberline {10.7.1.4}Caratteristiche e limiti}{132}{paragraph.10.7.1.4}%
\contentsline {paragraph}{\numberline {10.7.1.5}Tomoyo Linux}{132}{paragraph.10.7.1.5}%
\contentsline {paragraph}{\numberline {10.7.1.6}AppArmor}{132}{paragraph.10.7.1.6}%
\contentsline {paragraph}{\numberline {10.7.1.7}SELinux (Security-Enhanced Linux)}{133}{paragraph.10.7.1.7}%
\contentsline {paragraph}{\numberline {10.7.1.8}Fase 1: dal kernel alla query di autorizzazione}{133}{paragraph.10.7.1.8}%
\contentsline {paragraph}{\numberline {10.7.1.9}Fase 2: ricerca della policy SELinux}{134}{paragraph.10.7.1.9}%
\contentsline {paragraph}{\numberline {10.7.1.10}Stato di etichettamento (Labeling State)}{134}{paragraph.10.7.1.10}%
\contentsline {paragraph}{\numberline {10.7.1.11}Stato di transizione (Transition State)}{134}{paragraph.10.7.1.11}%
\contentsline {subparagraph}{\numberline {10.7.1.11.1}1. Transizione di file}{135}{subparagraph.10.7.1.11.1}%
\contentsline {subparagraph}{\numberline {10.7.1.11.2}2. Transizione di processo}{135}{subparagraph.10.7.1.11.2}%
\contentsline {subsection}{\numberline {10.8}Boot Time Security}{135}{subsection.10.8}%
\contentsline {paragraph}{\numberline {10.8.0.1}Funzionamento del Ramdisk durante il Boot}{135}{paragraph.10.8.0.1}%
\contentsline {paragraph}{\numberline {10.8.0.2}Horse Pills}{136}{paragraph.10.8.0.2}%
\contentsline {paragraph}{\numberline {10.8.0.3}Cosa può fare un ramdisk infetto}{136}{paragraph.10.8.0.3}%
\contentsline {paragraph}{\numberline {10.8.0.4}Mitigazioni e strategie di difesa}{137}{paragraph.10.8.0.4}%
\contentsline {subparagraph}{\numberline {10.8.0.4.1}1. Rilevazione}{137}{subparagraph.10.8.0.4.1}%
\contentsline {subparagraph}{\numberline {10.8.0.4.2}2. Prevenzione}{138}{subparagraph.10.8.0.4.2}%
\contentsline {subsection}{\numberline {10.9}Sicurezza di Rete a Livello OS}{138}{subsection.10.9}%
\contentsline {paragraph}{\numberline {10.9.0.1}inetd e xinetd}{138}{paragraph.10.9.0.1}%
\contentsline {paragraph}{\numberline {10.9.0.2}TCP Wrappers e Reverse DNS}{138}{paragraph.10.9.0.2}%
\contentsline {paragraph}{\numberline {10.9.0.3}File di configurazione}{138}{paragraph.10.9.0.3}%
\contentsline {paragraph}{\numberline {10.9.0.4}Esempi pratici}{139}{paragraph.10.9.0.4}%
\contentsline {paragraph}{\numberline {10.9.0.5}Ordine e logica di valutazione}{139}{paragraph.10.9.0.5}%
\contentsline {paragraph}{\numberline {10.9.0.6}Reverse DNS Tampering: il problema}{139}{paragraph.10.9.0.6}%
\contentsline {paragraph}{\numberline {10.9.0.7}Esempio di attacco semplificato}{139}{paragraph.10.9.0.7}%
\contentsline {paragraph}{\numberline {10.9.0.8}Contromisure pratiche}{139}{paragraph.10.9.0.8}%
\contentsline {paragraph}{\numberline {10.9.0.9}Conclusione}{140}{paragraph.10.9.0.9}%
\contentsline {section}{\numberline {11}SYS\_06 - Antivirus}{141}{section.11}%
\contentsline {subsection}{\numberline {11.1}Problemi principali degli antivirus}{141}{subsection.11.1}%
\contentsline {subsection}{\numberline {11.2}Evoluzione degli antivirus}{141}{subsection.11.2}%
\contentsline {subsection}{\numberline {11.3}Componenti di un antivirus}{141}{subsection.11.3}%
\contentsline {subsection}{\numberline {11.4}Esempi di packing}{142}{subsection.11.4}%
\contentsline {paragraph}{\numberline {11.4.0.1}1. Poche o nessuna importazione nella IAT (Import Address Table)}{142}{paragraph.11.4.0.1}%
\contentsline {paragraph}{\numberline {11.4.0.2}2. Nomi di sezioni non standard o incoerenti}{142}{paragraph.11.4.0.2}%
\contentsline {paragraph}{\numberline {11.4.0.3}3. Sezioni piccole su disco ma grandi in memoria}{142}{paragraph.11.4.0.3}%
\contentsline {paragraph}{\numberline {11.4.0.4}4. Poche stringhe leggibili}{142}{paragraph.11.4.0.4}%
\contentsline {paragraph}{\numberline {11.4.0.5}5. Sezioni con permessi RWX}{143}{paragraph.11.4.0.5}%
\contentsline {paragraph}{\numberline {11.4.0.6}6. Salti o chiamate a registri/indirizzi anomali}{143}{paragraph.11.4.0.6}%
\contentsline {subsection}{\numberline {11.5}Approccio operativo alla rilevazione}{143}{subsection.11.5}%
\contentsline {subsection}{\numberline {11.6}Tecniche di evasione}{144}{subsection.11.6}%
\contentsline {subsection}{\numberline {11.7}Analisi statica e comportamentale}{144}{subsection.11.7}%
\contentsline {paragraph}{\numberline {11.7.0.1}Analisi statica}{145}{paragraph.11.7.0.1}%
\contentsline {paragraph}{\numberline {11.7.0.2}Analisi comportamentale}{145}{paragraph.11.7.0.2}%
\contentsline {subsection}{\numberline {11.8}Emulatori e Fingerprinting}{147}{subsection.11.8}%
\contentsline {paragraph}{\numberline {11.8.0.1}Funzionamento degli emulatori}{147}{paragraph.11.8.0.1}%
\contentsline {paragraph}{\numberline {11.8.0.2}Limiti e tecniche di evasione}{147}{paragraph.11.8.0.2}%
\contentsline {paragraph}{\numberline {11.8.0.3}Fingerprinting dell’ambiente}{147}{paragraph.11.8.0.3}%
\contentsline {paragraph}{\numberline {11.8.0.4}Contromisure adottate dagli antivirus}{148}{paragraph.11.8.0.4}%
\contentsline {subsection}{\numberline {11.9}Analisi del traffico cifrato}{148}{subsection.11.9}%
\contentsline {subsection}{\numberline {11.10}Fiducia e limiti del software antivirus}{148}{subsection.11.10}%
\contentsline {section}{\numberline {12}SYS\_07 - eBPF}{149}{section.12}%
\contentsline {subsection}{\numberline {12.1}Motivazioni: Perché osservare ciò che accade nel cluster}{149}{subsection.12.1}%
\contentsline {subsection}{\numberline {12.2}Il ruolo del kernel e la necessità di strumenti avanzati}{149}{subsection.12.2}%
\contentsline {subsection}{\numberline {12.3}eBPF: Hooks nel kernel e nello user space}{150}{subsection.12.3}%
\contentsline {subsection}{\numberline {12.4}Sicurezza e osservabilità: un modello unificato}{150}{subsection.12.4}%
\contentsline {subsection}{\numberline {12.5}Tipologie di Hook eBPF}{150}{subsection.12.5}%
\contentsline {paragraph}{\numberline {12.5.0.1}Tracepoints Kernel (statici).}{151}{paragraph.12.5.0.1}%
\contentsline {paragraph}{\numberline {12.5.0.2}Kprobes (dinamici).}{151}{paragraph.12.5.0.2}%
\contentsline {paragraph}{\numberline {12.5.0.3}USDT (User Statically Defined Tracing).}{151}{paragraph.12.5.0.3}%
\contentsline {paragraph}{\numberline {12.5.0.4}Uprobes (dinamici).}{151}{paragraph.12.5.0.4}%
\contentsline {subsection}{\numberline {12.6}Tracepoints nel kernel}{151}{subsection.12.6}%
\contentsline {subsection}{\numberline {12.7}Sviluppo e caricamento di programmi eBPF con libbpf-bootstrap}{151}{subsection.12.7}%
\contentsline {subsection}{\numberline {12.8}Laboratorio: Tracepoint \texttt {openat}}{152}{subsection.12.8}%
\contentsline {subsection}{\numberline {12.9}User Statically Defined Tracing (USDT)}{153}{subsection.12.9}%
\contentsline {subsection}{\numberline {12.10}Kprobes e analisi dinamica del kernel}{153}{subsection.12.10}%
\contentsline {subsection}{\numberline {12.11}Uprobes: analisi dinamica di applicazioni user-space}{153}{subsection.12.11}%
\contentsline {subsection}{\numberline {12.12}Progetti reali basati su eBPF}{153}{subsection.12.12}%
\contentsline {subsection}{\numberline {12.13}Abuso dei BPF filter: il caso BPFDoor}{153}{subsection.12.13}%
\contentsline {subsection}{\numberline {12.14}Conclusioni}{153}{subsection.12.14}%
